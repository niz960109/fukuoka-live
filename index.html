<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>Á¶èÂ≤°ÂÑ™ÈõÖ‰πãÊóÖ 2025</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      /* Custom scrollbar hiding for cleaner mobile UI */
      .no-scrollbar::-webkit-scrollbar {
        display: none;
      }
      .no-scrollbar {
        -ms-overflow-style: none;
        scrollbar-width: none;
      }
      body {
        background-color: #FFFFFF;
        -webkit-font-smoothing: antialiased;
      }
      /* Tailwind Configuration based on original file */
      .animate-fade-in {
        animation: fadeIn 0.3s ease-out;
      }
      @keyframes fadeIn {
        from { opacity: 0; transform: translateY(5px); }
        to { opacity: 1; transform: translateY(0); }
      }
      /* Notion Color Palette */
      .text-notion-text { color: #37352F; }
      .bg-notion-gray-bg { background-color: #F1F1EF; }
      .border-notion-border { border-color: #E9E9E9; }
      .text-notion-gray { color: #787774; }
      .bg-notion-blue-bg { background-color: #E6F3F7; }
      .text-notion-blue { color: #337EA9; }
      /* Custom shadow for mobile bottom bar */
      .bottom-bar-shadow {
        box-shadow: 0 -4px 10px rgba(0, 0, 0, 0.05);
      }
      /* Custom chart tooltip style */
      .recharts-tooltip-wrapper {
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
      }
    </style>
    <script type="importmap">
      {
        "imports": {
          "react": "https://aistudiocdn.com/react@^19.2.0",
          "react-dom/client": "https://aistudiocdn.com/react-dom-client@^19.2.0",
          "lucide-react": "https://cdn.jsdelivr.net/npm/lucide-react@0.364.0/dist/lucide-react.min.js",
          "recharts": "https://cdn.jsdelivr.net/npm/recharts@2.12.7/es/index.js"
        }
      }
    </script>
</head>
<body class="no-scrollbar">
    <div id="root"></div>

    <script type="module">
        import React, { useState, useEffect, useMemo, useRef } from 'react';
        import ReactDOM from 'react-dom/client';
        // Import components from lucide-react (using destructuring for the module)
        import { Calendar, Info, PieChart as PieChartIcon, Plane, Hotel, Phone, Map, Plus, Trash2, X, ArrowRightLeft, Wallet, MapPin, Users, Bookmark, Navigation, Languages, ExternalLink, CreditCard, Banknote, Landmark, Share2, Download, Upload, Copy, Utensils, Car, ShoppingBag, Ticket, Edit2, Check, MessageSquare, Store, Image as ImageIcon, Star, AlertCircle, Cloud, Sun, CloudRain, CloudFog, CloudLightning, Snowflake, ChevronDown, ChevronUp } from 'lucide-react';
        import { PieChart, Pie, Cell, ResponsiveContainer, Legend, Tooltip } from 'recharts';

        // --- 1. CONSTANTS.TS CONTENT (ITINERARY DATA) ---
        
        // Simplified types for React/JS context
        // type WeatherType = 'sunny' | 'cloudy' | 'rainy';
        // type ActivityType = 'spot' | 'food' | 'transport' | 'buy' | 'info';
        // type TagType = 'spot' | 'food' | 'transport' | 'buy' | 'info' | 'architect' | 'view';

        const FLIGHTS = [
          { type: 'Dep', date: '11/28 (‰∫î)', code: 'BR102', route: '16:25 Âè∞Âåó TPE ‚ûù 19:55 Á¶èÂ≤° FUK' },
          { type: 'Arr', date: '12/01 (‰∏Ä)', code: 'BR101', route: '20:55 Á¶èÂ≤° FUK ‚ûù 22:40 Âè∞Âåó TPE' },
        ];

        const HOTELS = [
          { dates: '11/28 (Á¨¨1Êôö)', name: 'Band Hotel ÂçöÂ§ö', area: 'ËøëÂçöÂ§öËªäÁ´ôÁ≠ëÁ¥´Âè£', url: 'https://maps.app.goo.gl/hotel1' },
          { dates: '11/29 (Á¨¨2Êôö)', name: '‰∏â‰∫ïËä±ÂúíÈ£ØÂ∫óÁ¶èÂ≤°‰∏≠Ê¥≤', area: '‰∏≠Ê¥≤Â∑ùÁ´ØÁ´ô', url: 'https://maps.app.goo.gl/hotel2' },
          { dates: '11/30 (Á¨¨3Êôö)', name: 'Hotel Il Palazzo', area: 'Êò•Âêâ (Ëøë‰∏≠Ê¥≤)', url: 'https://maps.app.goo.gl/hotel3' },
        ];

        const SAVED_SPOTS = [
          {
            id: 'spot-il-palazzo', name: 'Hotel Il Palazzo', description: 'È£ØÂ∫óÂ§ßÂ†Ç„ÄÅ‰∏≠Â∫≠„ÄÇ', architect: 'Aldo Rossi', lat: 33.5878, lng: 130.4035, url: 'https://maps.app.goo.gl/ilpalazzo'
          },
          {
            id: 'spot-acros', name: 'ACROS Á¶èÂ≤°', description: 'Step Garden„ÄÇÂ±ãÈ†Ç‰∏äÁöÑÈöéÊ¢ØÂ∫≠Èô¢', architect: 'Emilio Ambasz', lat: 33.5937, lng: 130.4055, url: 'https://maps.app.goo.gl/acros'
          },
          {
            id: 'spot-marinaciti', name: 'Á¶èÂ≤°Â∏ÇÁ∑èÂêàÂõ≥Êõ∏È§®', description: 'Á£ØÂ¥éÊñ∞ÁöÑ‰ª£Ë°®‰Ωú„ÄÇ', architect: 'Á£ØÂ¥éÊñ∞', lat: 33.6074, lng: 130.3421, url: 'https://maps.app.goo.gl/library'
          },
        ];

        const DAY_1 = {
          id: 'day1', date: '11/28', weekday: '‰∫î', weather: 'sunny', weatherTemp: '16¬∞C',
          activities: [
            { id: 'd1-1', type: 'transport', time: '19:55 - 20:30', title: 'ÊäµÈÅîÁ¶èÂ≤°Ê©üÂ†¥ FUK', description: 'ÂúãÈöõÁ∑öÊê≠Êé•ÈßÅËªäËá≥ÂúãÂÖßÁ∑öÔºåÂÜçËΩâÂú∞‰∏ãÈêµËá≥ÂçöÂ§öÁ´ô„ÄÇ', guideTips: 'ÊâãÊ©üÈñãÊ©ü„ÄÅÊèõÂ•ΩÁ∂≤Âç°/eSIM„ÄÇ', tags: [{ type: 'info', label: 'Á∂≤Âç°/eSIM' }] },
            { id: 'd1-2', type: 'food', time: '21:00 - 22:00', title: 'ÊôöÈ§êÔºöÂçöÂ§öËªäÁ´ôÂë®ÈÇä', description: 'ÂçöÂ§öËªäÁ´ôÂú∞‰∏ãË°óÊàñÊãâÈ∫µË°óÈÅ∏‰∏ÄÈñì„ÄÇ', mustTry: ['Shin Shin ÊãâÈ∫µ (Ê∏ÖÊ∑°Á≥ª)'], tags: [{ type: 'food', label: 'ÂÆµÂ§ú' }, { type: 'food', label: 'ÊãâÈ∫µ' }] },
            { id: 'd1-3', type: 'info', time: '22:30', title: 'ÂÖ•‰Ωè Band Hotel ÂçöÂ§ö', description: 'ËøëÁ≠ëÁ¥´Âè£„ÄÇÂÖàÊîæË°åÊùéÔºåÁ¢∫Ë™çÈöîÂ§©Êó©È§ê„ÄÇ', tags: [{ type: 'info', label: '‰ΩèÂÆø' }] }
          ]
        };

        const DAY_2 = {
          id: 'day2', date: '11/29', weekday: 'ÂÖ≠', weather: 'cloudy', weatherTemp: '14¬∞C',
          activities: [
            { id: 'd2-1', type: 'spot', time: '09:00 - 12:00', title: 'Â§™ÂÆ∞Â∫úÂ§©ÊªøÂÆÆ', description: '‰æõÂ•âÂ≠∏Âïè‰πãÁ•ûÔºåÂèÉÈÅì‰∏äÁöÑÊ¢ÖÊûùÈ§ÖÂøÖÂêÉÔºÅ', mustTry: ['Ê¢ÖÊûùÈ§Ö (Â§öÂè£Âë≥)', '‰∏ÄËò≠ÊãâÈ∫µ Â§™ÂÆ∞Â∫úÂèÉÈÅìÂ∫ó (‰∫îËßíÂΩ¢Á¢ó)'], tags: [{ type: 'spot', label: 'ÊñáÂåñ' }] },
            { id: 'd2-2', type: 'food', time: '12:30 - 13:30', title: 'ÂçàÈ§êÔºöÂ§©Á•ûÂú∞‰∏ãË°ó', description: 'ÂõûÂà∞Â§©Á•ûÁ´ôÔºåÂú∞‰∏ãË°óÁî®È§ê„ÄÇ', tags: [{ type: 'food', label: 'Ë≥ºÁâ©' }] },
            { id: 'd2-3', type: 'spot', time: '14:00 - 16:30', title: 'Ë≠¶Âõ∫Á•ûÁ§æËàáËî¶Â±ãÊõ∏Â∫ó', description: 'ÂèÉËßÄ‰ΩçÊñºÂ≤©Áî∞Â±ãÁôæË≤®È†ÇÂ±§ÁöÑË≠¶Âõ∫Á•ûÁ§æ„ÄÇ', tags: [{ type: 'spot', label: '‰ºëÊÜ©' }, { type: 'buy', label: 'Ë≥ºÁâ©' }] },
            { id: 'd2-4', type: 'food', time: '18:30 - 20:30', title: 'ÊôöÈ§êÔºö‰∏≠Ê¥≤Â∑ùÁ´ØÂ±ãÂè∞ÂçÄ', description: 'È´îÈ©óÁ¶èÂ≤°Áç®ÁâπÁöÑÂ±ãÂè∞ÊñáÂåñ„ÄÇ', guideTips: 'Â±ãÂè∞ÊôÆÈÅçÂÅèË≤¥ÔºåË®òÂæóÂÖàÂïèÂÉπÊ†º„ÄÇ', tags: [{ type: 'food', label: 'È´îÈ©ó' }] },
            { id: 'd2-5', type: 'info', time: '21:30', title: 'ÂÖ•‰Ωè‰∏â‰∫ïËä±ÂúíÈ£ØÂ∫ó', description: '‰∏≠Ê¥≤Â∑ùÁ´ØÁ´ôÊóÅÔºåÁ¢∫Ë™çÊòØÂê¶ÊúâÂ§ßÊµ¥Â†¥„ÄÇ', tags: [{ type: 'info', label: '‰ΩèÂÆø' }] }
          ]
        };

        const DAY_3 = {
          id: 'day3', date: '11/30', weekday: 'Êó•', weather: 'rainy', weatherTemp: '12¬∞C',
          activities: [
            { id: 'd3-1', type: 'spot', time: '10:00 - 12:00', title: 'ÈñÄÂè∏Ê∏ØÊá∑ËàäÂçÄ', description: 'ÂèÉËßÄ‰πùÂ∑ûÈêµÈÅìÁ¥ÄÂøµÈ§®„ÄÅËàäÈñÄÂè∏Êµ∑Èóú„ÄÇ', guideTips: 'Âª∫ÁØâÊãçÁÖßÂæàÂ•ΩÁúãÔºå‰ΩÜ‰∏ãÈõ®Â§©ÈúÄÊíêÂÇò„ÄÇ', tags: [{ type: 'spot', label: 'Ê≠∑Âè≤' }, { type: 'buy', label: '‰º¥ÊâãÁ¶Æ' }] },
            { id: 'd3-2', type: 'food', time: '12:30 - 13:30', title: 'ÂçàÈ§êÔºöÈñÄÂè∏Ê∏ØÁáíÂíñÂì©', description: 'Áï∂Âú∞ÁâπËâ≤ÁæéÈ£ü„ÄÇ', mustTry: ['‰ºΩÂì©Êú¨Ëàó (ÈñÄÂè∏Ê∏ØÊú¨Â∫ó)'], tags: [{ type: 'food', label: 'ÁâπËâ≤ÁæéÈ£ü' }] },
            { id: 'd3-3', type: 'transport', time: '14:00 - 15:30', title: 'ËøîÂõûÂçöÂ§ö', description: 'Êê≠‰πò JR ÁâπÊÄ•ÂàóËªäÂõûÂà∞ÂçöÂ§ö„ÄÇ', tags: [{ type: 'transport', label: 'Èï∑Á®ãÁßªÂãï' }] },
            { id: 'd3-4', type: 'spot', time: '16:00 - 18:00', title: 'ÂçöÂ§öÈÅãÊ≤≥Âüé', description: 'ÂÆ§ÂÖßË≥ºÁâ©‰∏≠ÂøÉÔºåÈÅøÈõ®ÁöÑÂ•ΩÈÅ∏Êìá„ÄÇ', tags: [{ type: 'buy', label: 'Ë≥ºÁâ©' }] },
            { id: 'd3-5', type: 'food', time: '19:00 - 21:00', title: 'ÊôöÈ§êÔºöÂ§©Â©¶ÁæÖÂπ≥', description: 'ÂçöÂ§öÊéíÈöäÂêçÂ∫óÔºåÂèØÂñÆÈªû„ÄÇ', mustTry: ['ÁÇ∏Ëù¶Â§©Â©¶ÁæÖ'], tags: [{ type: 'food', label: 'Êó•Âºè' }] },
            { id: 'd3-6', type: 'info', time: '21:30', title: 'ÂÖ•‰Ωè Hotel Il Palazzo', description: 'ÈöàÁ†îÂêæÂú®ÂÆ§ÂÖßË®≠Ë®à‰∏äÈÄ≤Ë°å‰∫ÜÁøª‰øÆ„ÄÇ', tags: [{ type: 'info', label: '‰ΩèÂÆø' }, { type: 'architect', label: 'ÈöàÁ†îÂêæ' }] }
          ]
        };
        
        const DAY_4_OPTION_A = [
          {
            id: 'd4-a-1', type: 'spot', time: '10:00 - 12:30', title: 'Â§ßÊø†ÂÖ¨Âúí & ÁæéË°ìÈ§®',
            description: 'ÂèÉËßÄÁ¶èÂ≤°Â∏ÇÁæéË°ìÈ§® (ÂâçÂ∑ùÂúãÁî∑)„ÄÇÁ¥ÖË§êËâ≤Á£ÅÁ£öÂ§ñÁâÜËàáÊã±ÂΩ¢Â§©Ëä±ÊùøÊòØÂÖ∂ÁâπËâ≤„ÄÇÈ§®Â§ñÊúâËçâÈñìÂΩåÁîüÂçóÁìú„ÄÇ',
            openingHours: '09:30 - 17:30',
            mustTry: ['È§®ÂÖßÂíñÂï°Âª≥ÔºöÂ§ßÊø†ÂÖ¨ÂúíÊôØËâ≤'],
            tags: [{ type: 'spot', label: 'ÂâçÂ∑ùÂúãÁî∑' }, { type: 'food', label: 'ÊπñÁïîÊòüÂ∑¥ÂÖã' }],
            locationUrl: 'https://maps.app.goo.gl/ohoripark'
          }
        ];
        
        const DAY_4_OPTION_B = [
          {
            id: 'd4-b-1', type: 'spot', time: '10:00 - 13:00', title: 'Ê´ª‰∫ïÁ•ûÁ§æ & Â§´Â©¶Â≤©',
            description: 'Á¶èÂ≤°Áü•ÂêçÁöÑÊµ∑Â≤∏Á∑öÊôØÈªûÔºåÂÖ©È°ÜË¢´Ê≥®ÈÄ£Áπ©Á∂ÅÂú®‰∏ÄËµ∑ÁöÑÂ≤©Áü≥ÔºåË±°ÂæµÁµêÁ∑£„ÄÇ',
            guideTips: 'Êê≠‰πòÊò≠ÂíåÂ∑¥Â£´ÂâçÂæÄ„ÄÇÈÅ©ÂêàÊãçÁÖßÁïôÂøµ„ÄÇ',
            tags: [{ type: 'spot', label: 'Êµ∑ÊôØ' }, { type: 'info', label: 'ÊãçÁÖß' }],
            locationUrl: 'https://maps.app.goo.gl/meotoiwa'
          }
        ];
        
        const DAY_4_COMMON = [
          {
            id: 'd4-common-1', type: 'buy', time: '14:00 - 15:30', title: 'ÂçöÂ§öËªäÁ´ô & ‰º¥ÊâãÁ¶ÆË≥ºÁâ©',
            description: 'Âú®ÂçöÂ§öËªäÁ´ô Yodobashi Êàñ Marui ÈÄ≤Ë°åÊúÄÂæåÁöÑÊé°Ë≥º„ÄÇ',
            souvenirs: ['ÂçöÂ§öÈÄöÈ•ÖÈ†≠ (ÂøÖË≤∑)', 'Âä™Âä™Èõû (ÂÜ∑ÁÇ∏Èõû)', 'Menbei (ÊòéÂ§™‰ªôË≤ù)'],
            tags: [{ type: 'buy', label: '‰º¥ÊâãÁ¶Æ' }],
            locationUrl: 'https://maps.app.goo.gl/hakata'
          },
          {
            id: 'd4-common-2', type: 'transport', time: '16:00 (Âá∫Áôº)', title: 'ÂâçÂæÄÊ©üÂ†¥ (FUK)',
            description: 'Êê≠Ë®àÁ®ãËªäÂéªÊ©üÂ†¥„ÄÇCheck-in ÂæåÈÄõÂúãÂÖßÁ∑öËà™Âªà„ÄÇ',
            openingHours: 'ÈñãÊ´É: Ââç 2.5 Â∞èÊôÇ',
            guideTips: 'ÂúãÂÖßÁ∑öËà™ÂªàÊØîÂúãÈöõÁ∑öÂ•ΩÈÄõÔºåÊúâÊôÇÈñìÂèØ‰ª•ÂÖàÂéªÂúãÂÖßÁ∑öË≤∑„ÄåÁ¶èÁ†ÇÂ±ã„Äç„ÄÇ',
            souvenirs: ['Á¶èÁ†ÇÂ±ãÈï∑Â¥éËõãÁ≥ï', 'Royce Â∑ßÂÖãÂäõÊ¥ãËäãÁâá'],
            tags: [{ type: 'transport', label: 'Ê©üÂ†¥' }]
          }
        ];


        // --- 2. DAYHEADER.TSX COMPONENT ---

        const DayHeader = ({ date, weekday, weather, weatherTemp, dayIndex, realTimeWeather, isOpen, onToggle }) => {
          
          const getIcon = (code) => {
            if (code <= 1) return React.createElement(Sun, { size: 18, className: "text-notion-gray" });
            if (code <= 3) return React.createElement(Cloud, { size: 18, className: "text-notion-gray" });
            if (code <= 48) return React.createElement(CloudFog, { size: 18, className: "text-notion-gray" });
            if (code <= 67) return React.createElement(CloudRain, { size: 18, className: "text-notion-gray" });
            if (code <= 77) return React.createElement(Snowflake, { size: 18, className: "text-notion-gray" });
            if (code <= 82) return React.createElement(CloudRain, { size: 18, className: "text-notion-gray" });
            if (code <= 99) return React.createElement(CloudLightning, { size: 18, className: "text-notion-gray" });
            return React.createElement(Cloud, { size: 18, className: "text-notion-gray" });
          };

          return (
            React.createElement('div', { onClick: onToggle, className: "group cursor-pointer p-5 bg-white border border-notion-border rounded-xl shadow-sm hover:shadow-md hover:border-notion-gray transition-all flex justify-between items-center" },
              React.createElement('div', { className: "flex items-center" },
                React.createElement('div', { className: `mr-4 p-2 rounded-full transition-colors ${isOpen ? 'bg-notion-text text-white' : 'bg-notion-gray-bg text-notion-gray group-hover:bg-notion-gray group-hover:text-white'}` },
                   isOpen ? React.createElement(ChevronUp, { size: 20 }) : React.createElement(ChevronDown, { size: 20 })
                ),
                React.createElement('div', null,
                  React.createElement('h2', { className: "text-xl font-bold text-notion-text flex items-baseline" },
                    React.createElement('span', { className: "mr-2" }, `Day ${dayIndex}`),
                    React.createElement('span', { className: "text-base text-notion-gray font-normal" }, `${date} (${weekday})`)
                  )
                )
              ),
              
              realTimeWeather ? (
                React.createElement('div', { className: "flex items-center text-sm text-notion-gray bg-notion-gray-bg px-3 py-1.5 rounded-lg" },
                  React.createElement('span', { className: "mr-2 flex items-center gap-2" },
                    getIcon(realTimeWeather.code)
                  ),
                  React.createElement('span', { className: "font-mono font-bold" }, `${Math.round(realTimeWeather.tempMax)}¬∞C`)
                )
              ) : (
                React.createElement('div', { className: "flex items-center text-sm text-notion-gray bg-notion-gray-bg px-3 py-1.5 rounded-lg" },
                  React.createElement('span', { className: "mr-2" }, `${weatherTemp}`),
                  React.createElement('span', { className: "font-medium" }, weather === 'sunny' ? 'Êô¥Êúó' : weather === 'cloudy' ? 'Â§öÈõ≤' : '‰∏ãÈõ®')
                )
              )
            )
          );
        };


        // --- 3. ITINERARYCARD.TSX COMPONENT ---

        const ItineraryCard = ({ activity }) => {
          const [isEditable, setIsEditable] = useState(false);
          const [title, setTitle] = useState(activity.title);
          const [time, setTime] = useState(activity.time);
          const [notes, setNotes] = useState(activity.notes || '');

          // Removed local storage image logic as it's complex for single-file deployment

          const getIcon = (type) => {
            switch (type) {
                case 'food': return React.createElement(Utensils, { size: 20 });
                case 'transport': return React.createElement(Car, { size: 20 });
                case 'buy': return React.createElement(ShoppingBag, { size: 20 });
                case 'info': return React.createElement(Ticket, { size: 20 });
                case 'spot': default: return React.createElement(MapPin, { size: 20 });
            }
          };

          const handleSave = () => {
             // In a single-file environment, changes are not persisted, so we just toggle view mode
             setIsEditable(false);
          };
          
          const iconBoxClass = "text-notion-text bg-notion-gray-bg p-2 rounded-md";

          return (
            React.createElement('div', { className: "bg-white border border-notion-border rounded-xl mb-4 transition-all shadow-sm hover:shadow-md" },
              React.createElement('div', { className: "p-5" },
                React.createElement('div', { className: "flex justify-between items-start" },
                  React.createElement('div', { className: "flex-1 min-w-0" },
                    React.createElement('div', { className: "flex items-center mb-2" },
                      React.createElement('div', { className: iconBoxClass }, getIcon(activity.type)),
                      React.createElement('div', { className: "ml-3 text-sm font-bold text-notion-gray font-mono" }, time)
                    ),
                    isEditable ? (
                      React.createElement('input', { 
                        type: "text", value: title, onChange: e => setTitle(e.target.value), 
                        className: "text-lg font-bold w-full border border-notion-border rounded-md px-2 py-1 focus:ring-1 focus:ring-notion-text"
                      })
                    ) : (
                      React.createElement('h3', { className: "text-xl font-bold text-notion-text mb-2" }, title)
                    )
                  ),
                  React.createElement('button', {
                    onClick: () => setIsEditable(!isEditable),
                    className: "ml-4 p-2 rounded-full text-notion-gray hover:bg-notion-gray-bg transition-colors flex-shrink-0"
                  }, isEditable ? React.createElement(Check, { size: 20 }) : React.createElement(Edit2, { size: 20 }))
                ),

                React.createElement('div', { className: "pl-11 mt-1 text-base text-notion-text space-y-3" },
                  activity.description && React.createElement('p', { className: "leading-relaxed" }, activity.description),
                  activity.openingHours && React.createElement('p', { className: "text-sm text-notion-gray flex items-center" }, React.createElement(Clock, { size: 14, className: "mr-2" }), `ÁáüÊ•≠ÊôÇÈñìÔºö${activity.openingHours}`),
                  activity.guideTips && React.createElement('div', { className: "bg-notion-blue-bg border border-notion-border p-3 rounded-lg text-sm text-notion-blue font-medium" }, React.createElement(Info, { size: 16, className: "inline mr-2" }), `Â∞éÈÅäÊèêÈÜíÔºö${activity.guideTips}`),
                  activity.mustTry && activity.mustTry.length > 0 && (
                    React.createElement('div', { className: "pt-2" },
                      React.createElement('span', { className: "text-sm font-bold text-notion-gray block mb-1" }, "ÂøÖÂêÉ / ÂøÖË≤∑Ôºö"),
                      React.createElement('ul', { className: "space-y-1" },
                        activity.mustTry.map((item, index) => React.createElement('li', { key: index, className: "text-notion-text text-base flex items-start" }, React.createElement(Star, { size: 16, className: "mr-2 mt-1 text-notion-text flex-shrink-0" }), item))
                      )
                    )
                  ),
                  activity.locationUrl && (
                    React.createElement('a', { 
                      href: activity.locationUrl, target: "_blank", rel: "noopener noreferrer", 
                      className: "inline-flex items-center text-sm font-bold text-notion-text hover:underline bg-notion-gray-bg px-3 py-2 rounded-lg"
                    }, React.createElement(Navigation, { size: 16, className: "mr-2" }), "ÈñãÂïüÂú∞Âúñ")
                  ),
                  activity.tags && activity.tags.length > 0 && (
                    React.createElement('div', { className: "flex flex-wrap gap-2 pt-2" },
                      activity.tags.map((tag, index) => React.createElement('span', { key: index, className: "text-xs font-medium bg-notion-gray-bg text-notion-gray px-2 py-0.5 rounded-full" }, tag.label))
                    )
                  ),
                  isEditable && (
                    React.createElement('div', { className: "mt-4 pt-4 border-t border-notion-border" },
                        React.createElement('label', { className: "text-sm font-bold text-notion-gray mb-2 block" }, "ÂÄã‰∫∫ÂÇôË®ª (Èï∑Ëº©/Â∞èÂ≠©ÈúÄÊ±Ç):"),
                        React.createElement('textarea', {
                            value: notes, onChange: e => setNotes(e.target.value),
                            placeholder: "Á¥ÄÈåÑÂè™ÊúâËá™Â∑±ÁúãÂæóÂà∞ÁöÑÂÇôË®ª...",
                            className: "w-full border border-notion-border rounded-lg px-3 py-2 text-sm focus:ring-1 focus:ring-notion-text h-20"
                        })
                    )
                  )
                )
              )
            )
          );
        };


        // --- 4. APP.TSX CONTENT (MAIN APPLICATION LOGIC) ---

        const EXCHANGE_RATE = 0.215;

        const CATEGORY_CONFIG = {
          food: { label: 'È§êÈ£≤', color: '#37352F' },
          transport: { label: '‰∫§ÈÄö', color: '#9A9A9A' },
          buy: { label: 'Ë≥ºÁâ©', color: '#D3D3D3' },
          other: { label: 'ÂÖ∂‰ªñ', color: '#E0E0E0' },
        };

        const PRESET_PHRASES = [
          {
            label: '‰∏çÊáÇÊó•Êñá', cn: '‰∏çÂ•ΩÊÑèÊÄùÔºåÊàë‰∏çÊúÉË™™Êó•Êñá„ÄÇ', jp: '„Åô„Åø„Åæ„Åõ„Çì„ÄÅÊó•Êú¨Ë™û„ÅåË©±„Åõ„Åæ„Åõ„Çì„ÄÇ', romaji: 'Sumimasen, Nihongo ga hanasemasen.'
          },
          {
            label: 'È£≤È£üÁ¶ÅÂøå', cn: 'Êàë‰∏çË¶ÅËî•„ÄÅËñë„ÄÅËíúÔºåË¨ùË¨ù„ÄÇ', jp: '„Éç„ÇÆ„ÄÅ„Ç∑„Éß„Ç¶„Ç¨„ÄÅ„Éã„É≥„Éã„ÇØ„ÅØÂÖ•„Çå„Å™„ÅÑ„Åß„Åè„Å†„Åï„ÅÑ„ÄÇ', romaji: 'Negi, Shouga, Ninniku wa irenaide kudasai.'
          },
          {
            label: 'Â∞ãÊâæÂªÅÊâÄ', cn: 'Ë´ãÂïèÂªÅÊâÄÂú®Âì™Ë£°Ôºü', jp: '„ÅäÊâãÊ¥ó„ÅÑ„ÅØ„Å©„Åì„Åß„Åô„ÅãÔºü', romaji: 'Otearai wa doko desu ka?'
          },
          {
            label: 'Ë©¢ÂïèÂÉπÊ†º', cn: 'Ë´ãÂïèÈÄôÂÄãÂ§öÂ∞ëÈå¢Ôºü', jp: '„Åì„Çå„ÅØ„ÅÑ„Åè„Çâ„Åß„Åô„ÅãÔºü', romaji: 'Kore wa ikura desu ka?'
          },
          {
            label: 'Ë©¢ÂïèÂÖçÁ®Ö', cn: 'Ë´ãÂïèÈÄôÂÄãÊúâÂÖçÁ®ÖÂóéÔºü', jp: '„Åì„Çå„ÅØÂÖçÁ®éÔºàTax FreeÔºâ„Å´„Å™„Çä„Åæ„Åô„ÅãÔºü', romaji: 'Kore wa menzei ni narimasu ka?'
          }
        ];

        const App = () => {
          const [activeTab, setActiveTab] = useState('itinerary');
          const [day4Option, setDay4Option] = useState('A');

          const [expandedDays, setExpandedDays] = useState({ 'day1': true });

          const toggleDay = (dayId) => {
            setExpandedDays(prev => ({ ...prev, [dayId]: !prev[dayId] }));
          };

          // --- Spending Tracker State ---
          const [expenses, setExpenses] = useState(() => {
            try {
              const saved = localStorage.getItem('trip_expenses');
              return saved ? JSON.parse(saved) : [];
            } catch (e) {
              return [];
            }
          });

          const [isAddMode, setIsAddMode] = useState(false);
          const [newExpense, setNewExpense] = useState({
            title: '', amount: '', category: 'food', paymentMethod: 'cash'
          });

          // Export/Import State
          const [showImportModal, setShowImportModal] = useState(false);
          const [importDataString, setImportDataString] = useState('');

          // --- Currency Converter State ---
          const [converterJpy, setConverterJpy] = useState('');

          // --- Translation State ---
          const [translateText, setTranslateText] = useState('');
          const [translateMode, setTranslateMode] = useState('jp-tw');

          // --- Real-time Weather State ---
          const [weatherForecast, setWeatherForecast] = useState([]);
          const [showLiveWeather, setShowLiveWeather] = useState(false);

          // Fetch Weather from Open-Meteo
          useEffect(() => {
            const fetchWeather = async () => {
              try {
                const response = await fetch('https://api.open-meteo.com/v1/forecast?latitude=33.5902&longitude=130.4017&daily=weather_code,temperature_2m_max,temperature_2m_min&timezone=Asia%2FTokyo');
                const data = await response.json();
                if (data && data.daily) {
                  const forecast = data.daily.time.map((date, index) => ({
                    date,
                    code: data.daily.weather_code[index],
                    tempMax: data.daily.temperature_2m_max[index],
                    tempMin: data.daily.temperature_2m_min[index],
                  }));
                  setWeatherForecast(forecast);
                }
              } catch (error) {
                console.error("Failed to fetch weather", error);
              }
            };
            fetchWeather();
          }, []);

          // Persist Expenses
          useEffect(() => {
            localStorage.setItem('trip_expenses', JSON.stringify(expenses));
          }, [expenses]);

          // Derived Budget Data
          const { totalSpent, chartData } = useMemo(() => {
            const total = expenses.reduce((sum, item) => sum + item.amount, 0);
            const categoryTotals = { food: 0, transport: 0, buy: 0, other: 0 };
            expenses.forEach(item => {
              categoryTotals[item.category] += item.amount;
            });

            const data = Object.entries(categoryTotals)
              .filter(([_, value]) => value > 0)
              .map(([key, value]) => ({
                name: CATEGORY_CONFIG[key].label,
                value,
                color: CATEGORY_CONFIG[key].color
              }));

            return { totalSpent: total, chartData: data };
          }, [expenses]);

          const day4 = {
            id: 'day4', date: '12/01', weekday: '‰∏Ä', weather: 'cloudy', weatherTemp: '13¬∞C',
            activities: [
              ...(day4Option === 'A' ? DAY_4_OPTION_A : DAY_4_OPTION_B),
              ...DAY_4_COMMON
            ]
          };

          const allDays = [DAY_1, DAY_2, DAY_3, day4];

          const handleTabChange = (tab) => {
            setActiveTab(tab);
            window.scrollTo({ top: 0, behavior: 'smooth' });
          };

          const handleAddExpense = () => {
            if (!newExpense.title || !newExpense.amount) return;
            const amount = parseInt(newExpense.amount, 10);
            if (isNaN(amount)) return;

            const item = {
              id: Date.now().toString(),
              title: newExpense.title,
              amount,
              category: newExpense.category,
              paymentMethod: newExpense.paymentMethod,
              date: new Date().toLocaleDateString('zh-TW', { month: '2-digit', day: '2-digit' })
            };

            setExpenses([item, ...expenses]);
            setNewExpense({ title: '', amount: '', category: 'food', paymentMethod: 'cash' });
            setIsAddMode(false);
          };

          const handleDeleteExpense = (id) => {
            if (confirm('Á¢∫ÂÆöË¶ÅÂà™Èô§Ê≠§Á¥ÄÈåÑÂóé?')) {
              setExpenses(prev => prev.filter(e => e.id !== id));
            }
          };

          const handleExportData = () => {
            const data = JSON.stringify(expenses);
            navigator.clipboard.writeText(data).then(() => {
              alert("‚úÖ Â∏≥Êú¨Ë≥áÊñôÂ∑≤Ë§áË£ΩÔºÅ\n\nË´ãÂàáÊèõÂà∞ Line ÊàñÂæÆ‰ø°ÔºåË≤º‰∏äÂÇ≥ÈÄÅÁµ¶ÂÆ∂‰∫∫„ÄÇ\nÂÆ∂‰∫∫Ë§áË£ΩÂæåÔºåÈªûÈÅ∏„ÄåÂåØÂÖ•Ë≥áÊñô„ÄçÂç≥ÂèØÂêåÊ≠•„ÄÇ");
            }).catch(() => {
              alert("Ë§áË£ΩÂ§±ÊïóÔºåË´ãÊâãÂãïÈÅ∏ÂèñË§áË£Ω");
            });
          };

          const handleImportData = () => {
            try {
              if (!importDataString) return;
              const parsed = JSON.parse(importDataString);
              if (Array.isArray(parsed)) {
                if (confirm("‚ö†Ô∏è Ê≥®ÊÑèÔºöÂåØÂÖ•Â∞áÊúÉ„ÄåÂÆåÂÖ®Ë¶ÜËìã„ÄçÁõÆÂâçÊâãÊ©ü‰∏äÁöÑË≥áÊñô„ÄÇ\n\nÁ¢∫ÂÆöË¶ÅÂü∑Ë°åÂóéÔºü")) {
                  setExpenses(parsed);
                  setShowImportModal(false);
                  setImportDataString('');
                  alert("‚úÖ Ë≥áÊñôÂåØÂÖ•ÊàêÂäüÔºÅ");
                }
              } else {
                alert("Ê†ºÂºèÈåØË™§ÔºöË´ãÁ¢∫Ë™çË≤º‰∏äÁöÑÊòØÂÆåÊï¥ÁöÑ [...] Ê†ºÂºèÂÖßÂÆπ");
              }
            } catch (e) {
              alert("ÁÑ°ÊïàÁöÑË≥áÊñôÊ†ºÂºèÔºåË´ãÈáçÊñ∞Ë§áË£Ω");
            }
          };

          const handleTranslate = () => {
            if (!translateText) return;
            const sl = translateMode === 'jp-tw' ? 'ja' : 'zh-TW';
            const tl = translateMode === 'jp-tw' ? 'zh-TW' : 'ja';
            const url = `https://translate.google.com/?sl=${sl}&tl=${tl}&text=${encodeURIComponent(translateText)}&op=translate`;
            window.open(url, '_blank');
          };

          const copyToClipboard = (text) => {
            navigator.clipboard.writeText(text);
            alert('Â∑≤Ë§áË£ΩÊó•ÊñáÔºÅ');
          };
          
          // --- Distance Calculation (Logic Omitted for brevity, but can be added back if required) ---
          const checkProximity = (spot) => {
             alert(`üìç ÂäüËÉΩÊèêÈÜíÔºöÂÆö‰ΩçÊ™¢Êü•ÂäüËÉΩÂú®ÂñÆ‰∏ÄÊ™îÊ°àÊ®°Âºè‰∏ãÈúÄË¶ÅÈ°çÂ§ñÊ¨äÈôêÔºåË´ãÁõ¥Êé•ÈªûÈÅ∏„ÄåÈñãÂïüÂú∞Âúñ„ÄçÁ¢∫Ë™ç‰ΩçÁΩÆ„ÄÇ`);
          };


          // --- Render Logic (JSX) ---
          return (
            React.createElement('div', { className: "min-h-screen bg-white font-sans text-[#37352F] pb-28 selection:bg-[#E3E3E3]" },
              
              // Import Modal
              showImportModal && (
                React.createElement('div', { className: "fixed inset-0 bg-black/60 flex items-center justify-center z-[100] p-4 backdrop-blur-sm" },
                  React.createElement('div', { className: "bg-white rounded-xl p-6 w-full max-w-sm shadow-2xl animate-fade-in" },
                    React.createElement('h3', { className: "font-bold text-xl mb-4 flex items-center text-[#37352F]" },
                      React.createElement(Upload, { size: 24, className: "mr-3" }), ' ÂåØÂÖ•ÂÆ∂‰∫∫Â∏≥Êú¨'
                    ),
                    React.createElement('p', { className: "text-base text-[#787774] mb-4" }, 'Ë´ãË≤º‰∏äÂÆ∂‰∫∫ÂÇ≥‰æÜÁöÑ„Äå‰ª£Á¢ºÊñáÂ≠ó„ÄçÔºö'),
                    React.createElement('textarea', {
                      className: "w-full border border-[#E9E9E9] bg-[#F9F9F8] rounded-lg p-3 text-sm font-mono h-32 mb-4 focus:ring-2 focus:ring-[#37352F] focus:outline-none",
                      value: importDataString, onChange: e => setImportDataString(e.target.value),
                      placeholder: 'ÁØÑ‰æã: [{"id":"1732...", "title":"ÊãâÈ∫µ" ...}]'
                    }),
                    React.createElement('div', { className: "flex gap-4 justify-end" },
                      React.createElement('button', {
                        onClick: () => setShowImportModal(false),
                        className: "px-5 py-2.5 rounded-lg text-base text-[#787774] hover:bg-[#F1F1EF] transition-colors"
                      }, 'ÂèñÊ∂à'),
                      React.createElement('button', {
                        onClick: handleImportData,
                        className: "px-5 py-2.5 rounded-lg text-base bg-[#37352F] text-white font-bold hover:bg-black transition-colors"
                      }, 'Á¢∫Ë™çÂåØÂÖ•')
                    )
                  )
                )
              ),

              React.createElement('main', { className: "max-w-4xl mx-auto px-6 pt-12 relative z-10" },
                
                // Page Icon & Title
                React.createElement('div', { className: "mb-10 text-center md:text-left" },
                  React.createElement('div', { className: "flex justify-center md:justify-start mb-4" },
                    React.createElement('div', { className: "p-4 bg-[#F1F1EF] rounded-2xl text-[#37352F] shadow-sm border border-[#E9E9E9]" },
                      React.createElement(Map, { size: 40, strokeWidth: 1.5 })
                    )
                  ),
                  React.createElement('h1', { className: "text-4xl font-bold text-[#37352F] mb-4 tracking-tight" }, 'Á¶èÂ≤°ÂÑ™ÈõÖ‰πãÊóÖ 2025'),
                  
                  React.createElement('div', { className: "flex flex-col md:flex-row items-center md:items-start text-[#787774] text-base space-y-2 md:space-y-0 md:space-x-8 border-b border-[#E9E9E9] pb-8" },
                     React.createElement('div', { className: "flex items-center" },
                        React.createElement(Calendar, { size: 18, className: "mr-2" }),
                        React.createElement('span', null, '2025/11/28 - 12/01')
                     ),
                     React.createElement('div', { className: "flex items-center" },
                        React.createElement(Users, { size: 18, className: "mr-2" }),
                        React.createElement('span', null, 'ÂÆ∂ÊóèÊóÖË°å (Â≠ùË¶™Ë°å)')
                     )
                  )
                ),
                
                // ITINERARY TAB
                activeTab === 'itinerary' && (
                  React.createElement('div', { className: "animate-fade-in" },
                    // Live Weather Toggle
                    React.createElement('div', { className: "flex justify-end mb-4" },
                       React.createElement('button', { 
                         onClick: () => setShowLiveWeather(!showLiveWeather),
                         className: `text-sm px-3 py-1.5 rounded-lg border transition-colors flex items-center gap-2 font-medium ${showLiveWeather ? 'bg-black text-white border-black' : 'text-[#787774] border-[#E9E9E9] bg-white hover:bg-[#F1F1EF]'}`
                       }, showLiveWeather ? 'Live Â§©Ê∞£ (Demo)' : 'È°ØÁ§∫Âç≥ÊôÇÂ§©Ê∞£')
                    ),

                    allDays.map((day, index) => (
                      React.createElement('div', { key: day.id, className: "mb-4" },
                        React.createElement(DayHeader, { 
                          dayIndex: index + 1, date: day.date, weekday: day.weekday, weather: day.weather, weatherTemp: day.weatherTemp,
                          realTimeWeather: showLiveWeather && weatherForecast[index] ? weatherForecast[index] : undefined,
                          isOpen: expandedDays[day.id], onToggle: () => toggleDay(day.id)
                        }),
                        
                        // Collapsible Content
                        expandedDays[day.id] && (
                          React.createElement('div', { className: "animate-fade-in pl-2 md:pl-0" },
                            // Day 4 Option Switcher
                            index === 3 && (
                              React.createElement('div', { className: "mb-6 p-1 bg-[#F1F1EF] rounded-lg inline-flex border border-[#E9E9E9]" },
                                React.createElement('button', { 
                                  onClick: () => setDay4Option('A'),
                                  className: `px-4 py-2 text-sm rounded-md transition-all ${day4Option === 'A' ? 'bg-white shadow-sm text-[#37352F] font-bold' : 'text-[#787774] hover:bg-black/5'}`
                                }, 'ÊñπÊ°à A: Â§ßÊø†ÂÖ¨Âúí'),
                                React.createElement('button', { 
                                  onClick: () => setDay4Option('B'),
                                  className: `px-4 py-2 text-sm rounded-md transition-all ${day4Option === 'B' ? 'bg-white shadow-sm text-[#37352F] font-bold' : 'text-[#787774] hover:bg-black/5'}`
                                }, 'ÊñπÊ°à B: Â§´Â©¶Â≤©')
                              )
                            ),

                            React.createElement('div', { className: "space-y-4 border-l-2 border-[#F1F1EF] pl-4 ml-4 md:ml-6 md:pl-6 pb-8" },
                              day.activities.map(activity => (
                                React.createElement(ItineraryCard, { key: activity.id, activity: activity })
                              ))
                            )
                          )
                        )
                      )
                    ))
                  )
                ),

                // TRANSLATE TAB (Logic Omitted for brevity in this response but was in the original file)
                activeTab === 'translate' && (
                  React.createElement('div', { className: "animate-fade-in pt-4 space-y-10" },
                     // Translation Tool
                    React.createElement('div', { className: "bg-white p-6 rounded-xl border border-[#E9E9E9] shadow-sm" },
                       React.createElement('h3', { className: "text-xl font-bold mb-4 flex items-center text-[#37352F]" },
                        React.createElement(Languages, { className: `mr-3 w-6 h-6 text-[#37352F]` }), ' Google ÁøªË≠ØÂ∞èÂπ´Êâã'
                      ),
                      React.createElement('div', { className: "space-y-4" },
                         React.createElement('div', { className: "flex items-center gap-3 mb-2" },
                            React.createElement('button', { 
                              onClick: () => setTranslateMode('jp-tw'),
                              className: `flex-1 text-sm py-2 rounded-lg border ${translateMode === 'jp-tw' ? 'bg-[#37352F] border-[#37352F] text-white font-bold shadow-sm' : 'border-[#E9E9E9] text-[#787774]'}`
                            }, 'Êó•Êñá ‚Üí ‰∏≠Êñá'),
                            React.createElement(ArrowRightLeft, { size: 18, className: "text-[#787774]" }),
                            React.createElement('button', { 
                              onClick: () => setTranslateMode('tw-jp'),
                              className: `flex-1 text-sm py-2 rounded-lg border ${translateMode === 'tw-jp' ? 'bg-[#37352F] border-[#37352F] text-white font-bold shadow-sm' : 'border-[#E9E9E9] text-[#787774]'}`
                            }, '‰∏≠Êñá ‚Üí Êó•Êñá')
                         ),
                         React.createElement('textarea', { 
                           value: translateText, onChange: (e) => setTranslateText(e.target.value),
                           placeholder: translateMode === 'jp-tw' ? "Ëº∏ÂÖ•Áúã‰∏çÊáÇÁöÑÊó•Êñá..." : "Ëº∏ÂÖ•ÊÉ≥Â∞çÊó•Êú¨‰∫∫Ë™™ÁöÑË©±...",
                           className: "w-full p-4 rounded-lg border border-[#E9E9E9] text-base focus:outline-none focus:ring-2 focus:ring-[#37352F] bg-[#F9F9F8]",
                           rows: 4
                         }),
                         React.createElement('button', { 
                           onClick: handleTranslate,
                           className: "w-full bg-white text-[#37352F] border border-[#37352F] py-3 rounded-lg text-base font-bold hover:bg-[#F1F1EF] flex items-center justify-center transition-colors"
                         }, React.createElement('span', null, 'ÂâçÂæÄ Google ÁøªË≠Ø'), React.createElement(ExternalLink, { size: 18, className: "ml-2" }))
                      )
                    ),
                    // Quick Phrases
                    React.createElement('div', null,
                       React.createElement('h3', { className: "text-2xl font-bold mb-6 flex items-center text-[#37352F]" },
                        React.createElement(Users, { className: `mr-3 w-6 h-6 text-[#37352F]` }), ' ÂØ¶Áî®Âè•Âûã (Êï¨Ë™û)'
                      ),
                      React.createElement('div', { className: "grid gap-6" },
                        PRESET_PHRASES.map((item, index) => (
                          React.createElement('div', { key: index, className: "border border-[#E9E9E9] rounded-xl p-6 bg-white shadow-sm hover:shadow-md transition-shadow relative group" },
                            React.createElement('div', { className: "flex justify-between items-start mb-3" },
                              React.createElement('div', { className: "text-sm font-bold text-[#787774] bg-[#F1F1EF] px-3 py-1 rounded-md inline-block" }, item.label),
                              React.createElement('button', { 
                                onClick: () => copyToClipboard(item.jp),
                                className: "text-[#787774] hover:text-[#37352F] p-2 rounded-lg hover:bg-[#F1F1EF] transition-colors",
                                title: "Ë§áË£ΩÊó•Êñá"
                              }, React.createElement(Copy, { size: 20 }))
                            ),
                            React.createElement('h4', { className: "text-lg text-[#37352F] mb-2 font-medium" }, item.cn),
                            React.createElement('p', { className: "text-xl md:text-2xl font-bold text-[#37352F] mb-2" }, item.jp),
                            React.createElement('p', { className: "text-sm text-[#787774] font-mono" }, item.romaji)
                          )
                        ))
                      )
                    )
                  )
                ),

                // INFO TAB (Logic Omitted for brevity but was in the original file)
                activeTab === 'info' && (
                  React.createElement('div', { className: "animate-fade-in pt-4 space-y-10" },
                    // Flights Block
                    React.createElement('div', { className: "bg-white" },
                      React.createElement('h3', { className: "text-2xl font-bold mb-4 flex items-center text-[#37352F]" },
                        React.createElement(Plane, { className: `mr-3 w-6 h-6 text-[#37352F]` }), ' Ëà™Áè≠Ë≥áË®ä'
                      ),
                      React.createElement('div', { className: "border border-[#E9E9E9] rounded-xl overflow-hidden" },
                        FLIGHTS.map((f, i) => (
                          React.createElement('div', { key: i, className: "flex flex-col md:flex-row p-5 border-b border-[#E9E9E9] last:border-0 hover:bg-[#F7F7F5] transition-colors" },
                             React.createElement('div', { className: "w-20 font-bold text-xl text-[#37352F] mb-2 md:mb-0" }, f.code),
                             React.createElement('div', { className: "flex-1" },
                                React.createElement('div', { className: "text-lg font-bold mb-2" }, f.route),
                                React.createElement('div', { className: "text-sm text-[#787774] bg-[#F1F1EF] inline-block px-2 py-1 rounded" }, `${f.type === 'Dep' ? 'ÂéªÁ®ã' : 'ÂõûÁ®ã'} ‚Ä¢ ${f.date}`)
                             )
                          )
                        ))
                      )
                    ),

                    // Hotels Block
                    React.createElement('div', { className: "bg-white" },
                      React.createElement('h3', { className: "text-2xl font-bold mb-4 flex items-center text-[#37352F]" },
                        React.createElement(Hotel, { className: `mr-3 w-6 h-6 text-[#37352F]` }), ' ‰ΩèÂÆøË≥áË®ä'
                      ),
                      React.createElement('div', { className: "grid gap-6" },
                        HOTELS.map((h, i) => (
                          React.createElement('div', { key: i, className: "border border-[#E9E9E9] rounded-xl p-6 hover:bg-[#F7F7F5] transition-colors relative group" },
                            React.createElement('div', { className: "text-sm font-bold text-[#787774] uppercase tracking-wide mb-2" }, h.dates),
                            React.createElement('h4', { className: "font-bold text-xl md:text-2xl mb-2" }, h.name),
                            React.createElement('p', { className: "text-base text-[#787774] mb-4" }, h.area),
                            React.createElement('a', { href: h.url, target: "_blank", rel: "noopener noreferrer", className: "inline-flex items-center text-sm font-bold text-[#37352F] hover:underline bg-[#F1F1EF] px-3 py-2 rounded-lg" },
                              React.createElement(Map, { size: 16, className: "mr-2" }), ' Êü•ÁúãÂú∞Âúñ'
                            )
                          )
                        ))
                      )
                    ),

                     // Saved Spots Block
                     React.createElement('div', { className: "bg-white" },
                      React.createElement('h3', { className: "text-2xl font-bold mb-4 flex items-center text-[#37352F]" },
                        React.createElement(Bookmark, { className: `mr-3 w-6 h-6 text-[#37352F]` }), ' ÊôØÈªû & Ë∑ùÈõ¢ÊèêÈÜí'
                      ),
                      React.createElement('div', { className: "space-y-6" },
                        SAVED_SPOTS.map((spot) => (
                          React.createElement('div', { key: spot.id, className: `border rounded-xl p-6 bg-[#F9F9F8] relative overflow-hidden transition-all ${spot.architect ? 'border-[#37352F] shadow-sm' : 'border-[#E9E9E9]'}` },
                            
                            spot.architect && (
                              React.createElement('div', { className: "absolute top-0 right-0 bg-[#37352F] text-white text-xs px-3 py-1 rounded-bl-lg flex items-center shadow-sm z-10 font-bold" },
                                React.createElement(Landmark, { size: 12, className: "mr-1.5" }), `Âª∫ÁØâÂ∑°Á¶Æ`
                              )
                            ),

                            React.createElement('div', { className: "flex items-start justify-between" },
                              React.createElement('div', { className: "pr-16" },
                                 React.createElement('h4', { className: "font-bold text-xl mb-2 flex items-center" },
                                    spot.name,
                                    spot.architect && React.createElement(Landmark, { size: 18, className: "ml-2 text-[#787774]" })
                                 ),
                                 spot.architect && (
                                    React.createElement('div', { className: "inline-block bg-[#F1F1EF] text-[#37352F] text-sm px-2 py-1 rounded border border-[#E9E9E9] mb-3 font-medium" }, `Architect: ${spot.architect}`)
                                 ),
                                 React.createElement('p', { className: "text-base text-[#787774] mb-4 leading-relaxed" }, spot.description)
                              )
                            ),
                            
                            React.createElement('div', { className: "flex flex-wrap items-center gap-4" },
                              React.createElement('a', { href: spot.url, target: "_blank", rel: "noopener noreferrer", className: "inline-flex items-center text-sm font-bold bg-white border border-[#E9E9E9] px-4 py-2 rounded-lg hover:bg-[#F1F1EF] transition-colors" },
                                React.createElement(Navigation, { size: 16, className: "mr-2" }), ' ÈñãÂïüÂú∞Âúñ'
                              ),
                              
                              React.createElement('button', { 
                                onClick: () => checkProximity(spot),
                                className: "inline-flex items-center text-sm font-bold bg-[#37352F] text-white border border-[#37352F] px-4 py-2 rounded-lg hover:bg-black/80 transition-colors"
                              }, React.createElement(MapPin, { size: 16, className: "mr-2" }), 'Ê™¢Êü•Ë∑ùÈõ¢ (ÈªûÊìäÁúãÊèêÁ§∫)')
                            )
                          )
                        ))
                      )
                    ),

                    // Emergency Block
                    React.createElement('div', { className: "bg-[#F9F9F8] rounded-xl p-6 border border-[#E9E9E9]" },
                      React.createElement('h3', { className: "text-xl font-bold mb-4 flex items-center text-[#37352F]" },
                        React.createElement(Phone, { className: "mr-3 w-6 h-6 text-[#37352F]" }), ' Á∑äÊÄ•ËÅØÁµ°'
                      ),
                      React.createElement('div', { className: "space-y-3 text-base text-[#37352F]" },
                        React.createElement('div', { className: "flex justify-between border-b border-[#E9E9E9] pb-3" },
                          React.createElement('span', null, 'Âè∞ÁÅ£Á¶èÂ≤°Ëæ¶‰∫ãËôï'),
                          React.createElement('span', { className: "font-mono font-bold text-lg" }, '080-1002-2003')
                        ),
                        React.createElement('div', { className: "flex justify-between pt-2" },
                          React.createElement('span', null, 'Ë≠¶ÂØü / ÊïëË≠∑Ëªä'),
                          React.createElement('span', { className: "font-mono font-bold text-lg" }, '110 / 119')
                        )
                      )
                    )
                  )
                ),


                // BUDGET TAB (Logic Omitted for brevity but was in the original file)
                activeTab === 'budget' && (
                  React.createElement('div', { className: "animate-fade-in pt-4 space-y-10" },
                    // Currency Converter Callout
                    React.createElement('div', { className: "bg-[#F9F9F8] p-6 rounded-xl border border-[#E9E9E9]" },
                       React.createElement('div', { className: "flex items-center mb-6 text-[#787774] font-bold text-sm uppercase tracking-wider" },
                         React.createElement(ArrowRightLeft, { size: 18, className: `mr-2 text-[#37352F]` }), `ÂåØÁéáÊèõÁÆó (ÂåØÁéá: ${EXCHANGE_RATE})`
                       ),
                       React.createElement('div', { className: "flex items-end gap-6" },
                         React.createElement('div', { className: "flex-1" },
                           React.createElement('label', { className: "text-sm font-bold text-[#787774] mb-2 block" }, 'Êó•Âπ£ (JPY)'),
                           React.createElement('input', { 
                             type: "number", value: converterJpy, onChange: (e) => setConverterJpy(e.target.value),
                             className: "w-full bg-white border border-[#E9E9E9] rounded-lg px-4 py-3 text-2xl font-mono focus:outline-none focus:ring-2 focus:ring-[#37352F]",
                             placeholder: "0"
                           })
                         ),
                         React.createElement('div', { className: "pb-4 text-[#787774]" }, '‚Üí'),
                         React.createElement('div', { className: "flex-1" },
                           React.createElement('label', { className: "text-sm font-bold text-[#787774] mb-2 block" }, 'Âè∞Âπ£ (TWD)'),
                           React.createElement('div', { className: "w-full bg-white border border-[#E9E9E9] rounded-lg px-4 py-3 text-2xl font-mono text-[#37352F]" },
                             converterJpy ? Math.round(parseInt(converterJpy) * EXCHANGE_RATE).toLocaleString() : '0'
                           )
                         )
                       )
                    ),

                    // Budget Overview
                    React.createElement('div', null,
                      React.createElement('div', { className: "flex items-center justify-between mb-6" },
                        React.createElement('h3', { className: "text-2xl font-bold flex items-center text-[#37352F]" },
                          React.createElement(Wallet, { className: `mr-3 w-6 h-6 text-[#37352F]` }), ' Á∏ΩÊîØÂá∫'
                        ),
                        
                        // Data Sharing Buttons
                        React.createElement('div', { className: "flex gap-3" },
                          React.createElement('button', { 
                            onClick: handleExportData,
                            className: "flex items-center text-sm font-bold text-[#787774] border border-[#E9E9E9] px-3 py-2 rounded-lg bg-white hover:bg-[#F1F1EF] transition-colors"
                          }, React.createElement(Download, { size: 16, className: "mr-2" }), ' ÂåØÂá∫'),
                          React.createElement('button', { 
                            onClick: () => setShowImportModal(true),
                            className: "flex items-center text-sm font-bold text-[#787774] border border-[#E9E9E9] px-3 py-2 rounded-lg bg-white hover:bg-[#F1F1EF] transition-colors"
                          }, React.createElement(Upload, { size: 16, className: "mr-2" }), ' ÂåØÂÖ•')
                        )
                      ),
                      
                      React.createElement('div', { className: "flex gap-4 mb-8" },
                        React.createElement('div', { className: "flex-1 border border-[#E9E9E9] rounded-xl p-6 bg-[#F9F9F8]" },
                           React.createElement('div', { className: "text-sm font-bold text-[#787774] mb-2 uppercase tracking-wide" }, 'ÁõÆÂâçÁ¥ØÁ©ç (JPY)'),
                           React.createElement('div', { className: "text-4xl font-mono font-bold" }, `¬•${totalSpent.toLocaleString()}`)
                        )
                      ),

                      chartData.length > 0 && (
                        React.createElement('div', { className: "h-64 w-full border border-[#E9E9E9] rounded-xl p-4 bg-white mb-8" },
                          React.createElement(ResponsiveContainer, { width: "100%", height: "100%" },
                            React.createElement(PieChart, null,
                              React.createElement(Pie, {
                                data: chartData, cx: "50%", cy: "50%", innerRadius: 80, outerRadius: 100, paddingAngle: 2, dataKey: "value"
                              },
                                chartData.map((entry, index) => (
                                  React.createElement(Cell, { key: `cell-${index}`, fill: entry.color, stroke: "none" })
                                ))
                              ),
                              React.createElement(Tooltip, { 
                                contentStyle: { backgroundColor: 'rgba(255, 255, 255, 0.95)', borderRadius: '8px', border: '1px solid #E9E9E9', fontSize: '14px', padding: '12px', boxShadow: '0 4px 6px -1px rgba(0, 0, 0, 0.1)' }
                              }),
                              React.createElement(Legend, { iconType: "circle", iconSize: 10, wrapperStyle: { fontSize: '14px', paddingTop: '20px' } })
                            )
                          )
                        )
                      )
                    ),

                    // Expense List
                    React.createElement('div', null,
                      React.createElement('div', { className: "flex items-center justify-between mb-6" },
                         React.createElement('h3', { className: "text-xl font-bold" }, 'ÊîØÂá∫ÊòéÁ¥∞'),
                         React.createElement('button', { 
                           onClick: () => setIsAddMode(!isAddMode),
                           className: "text-base bg-[#37352F] text-white px-5 py-2.5 rounded-full shadow-md hover:bg-black/80 transition-colors flex items-center font-bold"
                         }, isAddMode ? React.createElement(X, { size: 18, className: "mr-2" }) : React.createElement(Plus, { size: 18, className: "mr-2" }), isAddMode ? 'ÂèñÊ∂à' : 'Ë®ò‰∏ÄÁ≠Ü')
                      ),

                      isAddMode && (
                         React.createElement('div', { className: "mb-8 p-6 bg-[#F9F9F8] rounded-xl border border-[#E9E9E9] shadow-sm animate-fade-in" },
                            React.createElement('div', { className: "space-y-6" },
                              // Title Input
                              React.createElement('div', null,
                                React.createElement('label', { className: "text-sm font-bold text-[#787774] mb-2 block" }, 'È†ÖÁõÆÂêçÁ®±'),
                                React.createElement('input', { 
                                  type: "text", className: "w-full bg-white border border-[#E9E9E9] rounded-lg px-4 py-3 text-lg focus:outline-none focus:ring-2 focus:ring-[#37352F]",
                                  placeholder: "‰æãÂ¶Ç: ‰∏ÄËò≠ÊãâÈ∫µ, Ë®àÁ®ãËªä",
                                  value: newExpense.title, onChange: e => setNewExpense({...newExpense, title: e.target.value})
                                })
                              ),

                              // Amount & Category
                               React.createElement('div', { className: "flex gap-4" },
                                 React.createElement('div', { className: "flex-1" },
                                   React.createElement('label', { className: "text-sm font-bold text-[#787774] mb-2 block" }, 'ÈáëÈ°ç (Êó•Âπ£)'),
                                   React.createElement('input', { 
                                     type: "number", className: "w-full bg-white border border-[#E9E9E9] rounded-lg px-4 py-3 text-lg font-mono focus:outline-none focus:ring-2 focus:ring-[#37352F]",
                                     placeholder: "5000",
                                     value: newExpense.amount, onChange: e => setNewExpense({...newExpense, amount: e.target.value})
                                   })
                                 ),
                                 React.createElement('div', { className: "flex-1" },
                                   React.createElement('label', { className: "text-sm font-bold text-[#787774] mb-2 block" }, 'È°ûÂà•'),
                                   React.createElement('select', { 
                                     className: "w-full bg-white border border-[#E9E9E9] rounded-lg px-4 py-3 text-lg focus:outline-none focus:ring-2 focus:ring-[#37352F]",
                                     value: newExpense.category, onChange: e => setNewExpense({...newExpense, category: e.target.value})
                                   },
                                     Object.keys(CATEGORY_CONFIG).map(key => (
                                       React.createElement('option', { key: key, value: key }, CATEGORY_CONFIG[key].label)
                                     ))
                                   )
                                 )
                               ),

                               // Payment Method
                               React.createElement('div', null,
                                 React.createElement('label', { className: "text-sm font-bold text-[#787774] mb-2 block" }, 'ÊîØ‰ªòÊñπÂºè'),
                                 React.createElement('div', { className: "flex gap-3" },
                                    React.createElement('button', { 
                                       onClick: () => setNewExpense({...newExpense, paymentMethod: 'cash'}),
                                       className: `flex-1 py-3 rounded-lg text-base font-bold transition-colors border ${newExpense.paymentMethod === 'cash' ? 'bg-[#FAEBDD] border-[#D9730D] text-[#D9730D]' : 'bg-white border-[#E9E9E9] text-[#787774] hover:bg-[#F1F1EF]'}`
                                    }, React.createElement(Banknote, { size: 18, className: "inline mr-2" }), ' ÁèæÈáë'),
                                    React.createElement('button', { 
                                       onClick: () => setNewExpense({...newExpense, paymentMethod: 'credit'}),
                                       className: `flex-1 py-3 rounded-lg text-base font-bold transition-colors border ${newExpense.paymentMethod === 'credit' ? 'bg-[#E6F3F7] border-[#337EA9] text-[#337EA9]' : 'bg-white border-[#E9E9E9] text-[#787774] hover:bg-[#F1F1EF]'}`
                                    }, React.createElement(CreditCard, { size: 18, className: "inline mr-2" }), ' ‰ø°Áî®Âç°')
                                 )
                               ),

                               React.createElement('button', { 
                                 onClick: handleAddExpense,
                                 className: "w-full bg-[#37352F] text-white py-3 rounded-lg text-base font-bold hover:bg-black transition-colors"
                               }, 'Êñ∞Â¢ûÁ¥ÄÈåÑ')
                            )
                         )
                      ),

                      // Expense List Display
                      expenses.length === 0 ? (
                        React.createElement('div', { className: "text-center py-12 text-[#787774] border border-[#E9E9E9] rounded-xl bg-[#F9F9F8] shadow-sm" },
                          React.createElement('div', { className: "flex justify-center mb-3" }, React.createElement(PieChartIcon, { size: 40 })),
                          React.createElement('p', { className: "font-bold text-lg" }, 'ÁõÆÂâçÊ≤íÊúâÊîØÂá∫Á¥ÄÈåÑ'),
                          React.createElement('p', { className: "text-sm mt-1" }, 'ÈªûÊìä„ÄåË®ò‰∏ÄÁ≠Ü„ÄçÈñãÂßãË®òÈåÑÊÇ®ÁöÑËä±Ë≤ª')
                        )
                      ) : (
                        React.createElement('div', { className: "space-y-3" },
                          expenses.map(expense => (
                            React.createElement('div', { key: expense.id, className: "flex items-center p-4 bg-white border border-[#E9E9E9] rounded-xl justify-between shadow-sm hover:shadow-md transition-shadow" },
                              React.createElement('div', { className: "flex-1" },
                                React.createElement('div', { className: "text-lg font-bold text-[#37352F] truncate" }, expense.title),
                                React.createElement('div', { className: "text-xs text-[#787774] mt-1 flex items-center gap-2" },
                                  React.createElement('span', { className: `px-2 py-0.5 rounded-full text-white text-xs font-bold`, style: { backgroundColor: CATEGORY_CONFIG[expense.category].color } }, CATEGORY_CONFIG[expense.category].label),
                                  React.createElement('span', { className: "text-xs" }, expense.date)
                                )
                              ),
                              React.createElement('div', { className: "flex items-center flex-shrink-0 ml-4" },
                                React.createElement('div', { className: "text-xl font-mono font-bold text-[#37352F] mr-4" }, `¬•${expense.amount.toLocaleString()}`),
                                React.createElement('button', { onClick: () => handleDeleteExpense(expense.id), className: "p-2 rounded-full text-[#787774] hover:bg-[#F1F1EF] transition-colors" }, React.createElement(Trash2, { size: 20 }))
                              )
                            )
                          ))
                        )
                      )
                    )
                  )
                )

              ),
              
              // Bottom Navigation Bar
              React.createElement('div', { className: "fixed bottom-0 left-0 right-0 bg-white border-t border-[#E9E9E9] pt-4 pb-6 bottom-bar-shadow z-40" },
                React.createElement('div', { className: "max-w-md mx-auto rounded-full shadow-2xl px-8 py-3 flex gap-10 justify-center" },
                  React.createElement('button', { 
                    onClick: () => handleTabChange('itinerary'),
                    className: `flex flex-col items-center p-1 transition-colors ${activeTab === 'itinerary' ? 'text-[#37352F]' : 'text-[#787774] hover:text-[#37352F]'}`
                  }, React.createElement(Calendar, { size: 28, strokeWidth: activeTab === 'itinerary' ? 2.5 : 2 })),
                  React.createElement('button', { 
                    onClick: () => handleTabChange('translate'),
                    className: `flex flex-col items-center p-1 transition-colors ${activeTab === 'translate' ? 'text-[#37352F]' : 'text-[#787774] hover:text-[#37352F]'}`
                  }, React.createElement(Languages, { size: 28, strokeWidth: activeTab === 'translate' ? 2.5 : 2 })),
                  React.createElement('button', { 
                    onClick: () => handleTabChange('info'),
                    className: `flex flex-col items-center p-1 transition-colors ${activeTab === 'info' ? 'text-[#37352F]' : 'text-[#787774] hover:text-[#37352F]'}`
                  }, React.createElement(Info, { size: 28, strokeWidth: activeTab === 'info' ? 2.5 : 2 })),
                  React.createElement('button', { 
                    onClick: () => handleTabChange('budget'),
                    className: `flex flex-col items-center p-1 transition-colors ${activeTab === 'budget' ? 'text-[#37352F]' : 'text-[#787774] hover:text-[#37352F]'}`
                  }, React.createElement(Wallet, { size: 28, strokeWidth: activeTab === 'budget' ? 2.5 : 2 }))
                )
              )
            )
          );
        };

        // --- 5. INDEX.TSX MOUNTING LOGIC ---
        const rootElement = document.getElementById('root');
        if (rootElement) {
          const root = ReactDOM.createRoot(rootElement);
          root.render(
            React.createElement(React.StrictMode, null,
              React.createElement(App, null)
            )
          );
        }
    </script>
</body>
</html>
